<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ì¹´ì¹´ì˜¤ ì£¼ì†Œ ê²€ìƒ‰</title>
    <style>
      body {
        font-family: sans-serif;
        margin: 0;
        padding: 10px;
      }
      input,
      button {
        padding: 6px;
        margin: 4px 0;
        width: 100%;
      }
      #wrap {
        display: none;
        border: 1px solid #ccc;
        width: 100%;
        height: 300px;
        position: relative;
        margin-top: 10px;
      }
      #btnFoldWrap {
        cursor: pointer;
        position: absolute;
        right: 0;
        top: 0;
        z-index: 1;
      }
      #submitButton {
        margin-top: 10px;
        background-color: #4a68ea;
        color: white;
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <h3>ğŸ“ ì£¼ì†Œ ê²€ìƒ‰</h3>

    <input type="text" id="sample3_postcode" placeholder="ìš°í¸ë²ˆí˜¸" />
    <button onclick="sample3_execDaumPostcode()">ìš°í¸ë²ˆí˜¸ ì°¾ê¸°</button>
    <input type="text" id="sample3_address" placeholder="ì£¼ì†Œ" />
    <input type="text" id="sample3_extraAddress" placeholder="ì‹œ/êµ¬/ë™" />

    <button id="submitButton" onclick="submitAddress()">ì„ íƒ ì™„ë£Œ</button>

    <div id="wrap">
      <img
        src="//t1.daumcdn.net/postcode/resource/images/close.png"
        id="btnFoldWrap"
        onclick="foldDaumPostcode()"
        alt="ì ‘ê¸° ë²„íŠ¼"
      />
    </div>

    <script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
    <script>
      var element_wrap = document.getElementById("wrap");

      function foldDaumPostcode() {
        element_wrap.style.display = "none";
      }

      function sample3_execDaumPostcode() {
        new daum.Postcode({
          oncomplete: function (data) {
            var addr = "";
            var extraAddr = "";

            if (data.userSelectedType === "R") {
              addr = data.roadAddress;
            } else {
              addr = data.jibunAddress;
            }

            // ì‹œ/êµ¬/ë™ ì¡°í•©
            var fullLocation = "";
            if (data.sido) fullLocation += data.sido;
            if (data.sigungu) fullLocation += " " + data.sigungu;
            if (data.bname) fullLocation += " " + data.bname;

            document.getElementById("sample3_extraAddress").value =
              fullLocation;
            document.getElementById("sample3_postcode").value = data.zonecode;
            document.getElementById("sample3_address").value = addr;

            element_wrap.style.display = "none";
          },
          onresize: function (size) {
            element_wrap.style.height = size.height + "px";
          },
          width: "100%",
          height: "100%",
        }).embed(element_wrap);

        element_wrap.style.display = "block";
      }

      function submitAddress() {
        const addr = document.getElementById("sample3_address").value;
        const extra = document.getElementById("sample3_extraAddress").value;
        const postal = document.getElementById("sample3_postcode").value;

        const result = {
          address: addr,
          postalCode: postal,
          extra: extra,
        };

        // Windows WebView (webview_windows í”ŒëŸ¬ê·¸ì¸)ë¡œ ì „ì†¡
        if (window.chrome && window.chrome.webview) {
          window.chrome.webview.postMessage(JSON.stringify(result));
        } else if (window.FlutterChannel) {
          // ëª¨ë°”ì¼(Android/iOS) í™˜ê²½: Flutterì—ì„œ ë“±ë¡í•œ JavaScript ì±„ë„ ì´ë¦„ ì‚¬ìš©
          FlutterChannel.postMessage(JSON.stringify(result));
        }
      }
    </script>
  </body>
</html>
